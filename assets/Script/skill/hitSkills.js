var SkillBase=require("Skill").SkillBase;
var HitSkill=cc.Class({
    extends:SkillBase,
    properties:{
        damageCoe:1,
        preTime:0.5,
        
        startFlag:false,
        targetInter:null,
    },
    cast:function(){
        this.unitBase.bulletManager.skillCreateBullet(this.unit,this.targetInter)
    },
    bind:function(unit){
        this._super.apply(this,arguments);
        this.unitSkill.addListener("hit",this,this.onUnitHit);
        this.unitSkill.addListener("update",this,this.onUnitUpdate);
    },
    onUnitHit:function(targetInter){
        this.unitSkill.attackLock();
        this.preTime=0.5;
        this.startFlag=true;
        this.targetInter=targetInter;
    },
    onUnitUpdate:function(dt){
        if(this.startFlag){
            if(this.preTime<=0){
                this.cast();
                this.startFlag=false;
                this.preTime=0.5;
                this.targetInter=null;
                this.unitSkill.attackUnlock();
            }else{
                this.preTime-=dt;
            }
        }
    },
});
var ShotSkill=cc.Class({
    extends:SkillBase,
    properties:{
        damageCoe:1,
        preTime:0.5,
        
        startFlag:false,
        targetInter:null,
    },
    cast:function(){
        this.unitBase.bulletManager.skillCreateStraightBullet(this.unit,this.targetInter)
    },
    bind:function(unit){
        this._super.apply(this,arguments);
        this.unitSkill.addListener("hit",this,this.onUnitHit);
        this.unitSkill.addListener("update",this,this.onUnitUpdate);
    },
    onUnitHit:function(targetInter){
        this.unitSkill.attackLock();
        this.preTime=0.5;
        this.startFlag=true;
        this.targetInter=targetInter;
    },
    onUnitUpdate:function(dt){
        if(this.startFlag){
            if(this.preTime<=0){
                this.cast();
                this.startFlag=false;
                this.preTime=0.5;
                this.targetInter=null;
                this.unitSkill.attackUnlock();
            }else{
                this.preTime-=dt;
            }
        }
    },
});
module.exports={
    HitSkill:HitSkill,
    ShotSkill:ShotSkill
}